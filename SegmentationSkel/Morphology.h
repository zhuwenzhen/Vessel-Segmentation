#ifndef MORPHOLOGY_H
#define MORPHOLOGY_H

#include "ImageDatabase.h"
#include <FL/Fl.H>
#include <vector>;
#include "ImageLib/Image.h"

class Fl_Image;
const double gaussian15x15[15][15] = { { 0.0000000597598,0.000000284274,0.00000117365,0.0000041166,0.0000119272,0.0000274842,0.000047825,0.0000587168,0.000047825,0.0000274842,0.0000119272,0.0000041166,0.00000117365,0.000000284274,0.0000000597598 },{ 0.000000284274,0.00000135228,0.00000558299,0.0000195824,0.0000567371,0.000130741,0.000227501,0.000279313,0.000227501,0.000130741,0.0000567371,0.0000195824,0.00000558299,0.00000135228,0.000000284274 },{ 0.00000117365,0.00000558299,0.0000230498,0.0000808478,0.000234244,0.000539775,0.000939256,0.00115317,0.000939256,0.000539775,0.000234244,0.0000808478,0.0000230498,0.00000558299,0.00000117365 },{ 0.0000041166,0.0000195824,0.0000808478,0.000283575,0.000821616,0.00189327,0.00329446,0.00404475,0.00329446,0.00189327,0.000821616,0.000283575,0.0000808478,0.0000195824,0.0000041166 },{ 0.0000119272,0.0000567371,0.000234244,0.000821616,0.00238051,0.00548546,0.00954519,0.0117191,0.00954519,0.00548546,0.00238051,0.000821616,0.000234244,0.0000567371,0.0000119272 },{ 0.0000274842,0.000130741,0.000539775,0.00189327,0.00548546,0.0126403,0.0219952,0.0270045,0.0219952,0.0126403,0.00548546,0.00189327,0.000539775,0.000130741,0.0000274842 },{ 0.000047825,0.000227501,0.000939256,0.00329446,0.00954519,0.0219952,0.0382737,0.0469903,0.0382737,0.0219952,0.00954519,0.00329446,0.000939256,0.000227501,0.000047825 },{ 0.0000587168,0.000279313,0.00115317,0.00404475,0.0117191,0.0270045,0.0469903,0.0576921,0.0469903,0.0270045,0.0117191,0.00404475,0.00115317,0.000279313,0.0000587168 },{ 0.000047825,0.000227501,0.000939256,0.00329446,0.00954519,0.0219952,0.0382737,0.0469903,0.0382737,0.0219952,0.00954519,0.00329446,0.000939256,0.000227501,0.000047825 },{ 0.0000274842,0.000130741,0.000539775,0.00189327,0.00548546,0.0126403,0.0219952,0.0270045,0.0219952,0.0126403,0.00548546,0.00189327,0.000539775,0.000130741,0.0000274842 },{ 0.0000119272,0.0000567371,0.000234244,0.000821616,0.00238051,0.00548546,0.00954519,0.0117191,0.00954519,0.00548546,0.00238051,0.000821616,0.000234244,0.0000567371,0.0000119272 },{ 0.0000041166,0.0000195824,0.0000808478,0.000283575,0.000821616,0.00189327,0.00329446,0.00404475,0.00329446,0.00189327,0.000821616,0.000283575,0.0000808478,0.0000195824,0.0000041166 },{ 0.00000117365,0.00000558299,0.0000230498,0.0000808478,0.000234244,0.000539775,0.000939256,0.00115317,0.000939256,0.000539775,0.000234244,0.0000808478,0.0000230498,0.00000558299,0.00000117365 },{ 0.000000284274,0.00000135228,0.00000558299,0.0000195824,0.0000567371,0.000130741,0.000227501,0.000279313,0.000227501,0.000130741,0.0000567371,0.0000195824,0.00000558299,0.00000135228,0.000000284274 },{ 0.0000000597598,0.000000284274,0.00000117365,0.0000041166,0.0000119272,0.0000274842,0.000047825,0.0000587168,0.000047825,0.0000274842,0.0000119272,0.0000041166,0.00000117365,0.000000284274,0.0000000597598 } };
const int structSquare[8][2] = { { -1, -1 },{ -1, 0 },{ -1, 1 },{ 0,1 },{ 1,1 },{ 1,0 },{ 1,-1 },{ 0,-1 } };
const int structureElement[12][15][2] = { { { -7,0 },{ -6,0 },{ -5,0 },{ -4,0 },{ -3,0 },{ -2,0 },{ -1,0 },{ 0,0 },{ 1,0 },{ 2,0 },{ 3,0 },{ 4,0 },{ 5,0 },{ 6,0 },{ 7,0 } },{ { -7,-2 },{ -6,-2 },{ -5,-1 },{ -4,-1 },{ -3,-1 },{ -2,-1 },{ -1,0 },{ 0,0 },{ 1,0 },{ 2,1 },{ 3,1 },{ 4,1 },{ 5,1 },{ 6,2 },{ 7,2 } },{ { -6,-4 },{ -5,-3 },{ -4,-2 },{ -3,-2 },{ -3,-2 },{ -2,-1 },{ -1,0 },{ 0,0 },{ 1,0 },{ 2,1 },{ 3,2 },{ 3,2 },{ 4,2 },{ 5,3 },{ 6,4 } },{ { -5,-5 },{ -4,-4 },{ -4,-4 },{ -3,-3 },{ -2,-2 },{ -1,-1 },{ -1,-1 },{ 0,0 },{ 1,1 },{ 1,1 },{ 2,2 },{ 3,3 },{ 4,4 },{ 4,4 },{ 5,5 } },{ { -4,-6 },{ -3,-5 },{ -2,-4 },{ -2,-3 },{ -2,-3 },{ -1,-2 },{ 0,-1 },{ 0,0 },{ 0,1 },{ 1,2 },{ 2,3 },{ 2,3 },{ 2,4 },{ 3,5 },{ 4,6 } },{ { -2,-7 },{ -2,-6 },{ -1,-5 },{ -1,-4 },{ -1,-3 },{ -1,-2 },{ 0,-1 },{ 0,0 },{ 0,1 },{ 1,2 },{ 1,3 },{ 1,4 },{ 1,5 },{ 2,6 },{ 2,7 } },{ { 0,-7 },{ 0,-6 },{ 0,-5 },{ 0,-4 },{ 0,-3 },{ 0,-2 },{ 0,-1 },{ 0,0 },{ 0,1 },{ 0,2 },{ 0,3 },{ 0,4 },{ 0,5 },{ 0,6 },{ 0,7 } },{ { 2,-7 },{ 2,-6 },{ 1,-5 },{ 1,-4 },{ 1,-3 },{ 1,-2 },{ 0,-1 },{ 0,0 },{ 0,1 },{ -1,2 },{ -1,3 },{ -1,4 },{ -1,5 },{ -2,6 },{ -2,7 } },{ { 4,-6 },{ 3,-5 },{ 2,-4 },{ 2,-3 },{ 2,-3 },{ 1,-2 },{ 0,-1 },{ 0,0 },{ 0,1 },{ -1,2 },{ -2,3 },{ -2,3 },{ -2,4 },{ -3,5 },{ -4,6 } },{ { 5,-5 },{ 4,-4 },{ 4,-4 },{ 3,-3 },{ 2,-2 },{ 1,-1 },{ 1,-1 },{ 0,0 },{ -1,1 },{ -1,1 },{ -2,2 },{ -3,3 },{ -4,4 },{ -4,4 },{ -5,5 } },{ { 6,-4 },{ 5,-3 },{ 4,-2 },{ 3,-2 },{ 3,-2 },{ 2,-1 },{ 1,0 },{ 0,0 },{ -1,0 },{ -2,1 },{ -3,2 },{ -3,2 },{ -4,2 },{ -5,3 },{ -6,4 } },{ { 7,-2 },{ 6,-2 },{ 5,-1 },{ 4,-1 },{ 3,-1 },{ 2,-1 },{ 1,0 },{ 0,0 },{ -1,0 },{ -2,1 },{ -3,1 },{ -4,1 },{ -5,1 },{ -6,2 },{ -7,2 } } };
const int structureElement2[12][31][2] = { { { -15,0 },{ -14,0 },{ -13,0 },{ -12,0 },{ -11,0 },{ -10,0 },{ -9,0 },{ -8,0 },{ -7,0 },{ -6,0 },{ -5,0 },{ -4,0 },{ -3,0 },{ -2,0 },{ -1,0 },{ 0,0 },{ 1,0 },{ 2,0 },{ 3,0 },{ 4,0 },{ 5,0 },{ 6,0 },{ 7,0 },{ 8,0 },{ 9,0 },{ 10,0 },{ 11,0 },{ 12,0 },{ 13,0 },{ 14,0 } },
{ { -14,-4 },{ -14,-4 },{ -13,-3 },{ -12,-3 },{ -11,-3 },{ -10,-3 },{ -9,-2 },{ -8,-2 },{ -7,-2 },{ -6,-2 },{ -5,-1 },{ -4,-1 },{ -3,-1 },{ -2,-1 },{ -1,0 },{ 0,0 },{ 1,0 },{ 2,1 },{ 3,1 },{ 4,1 },{ 5,1 },{ 6,2 },{ 7,2 },{ 8,2 },{ 9,2 },{ 10,3 },{ 11,3 },{ 12,3 },{ 13,3 },{ 14,4 } },
{ { -13,-8 },{ -12,-7 },{ -11,-6 },{ -10,-6 },{ -10,-6 },{ -9,-5 },{ -8,-4 },{ -7,-4 },{ -6,-4 },{ -5,-3 },{ -4,-2 },{ -3,-2 },{ -3,-2 },{ -2,-1 },{ -1,0 },{ 0,0 },{ 1,0 },{ 2,1 },{ 3,2 },{ 3,2 },{ 4,2 },{ 5,3 },{ 6,4 },{ 7,4 },{ 8,4 },{ 9,5 },{ 10,6 },{ 10,6 },{ 11,6 },{ 12,7 } },{ { -11,-11 },{ -10,-10 },{ -9,-9 },{ -8,-8 },{ -8,-8 },{ -7,-7 },{ -6,-6 },{ -6,-6 },{ -5,-5 },{ -4,-4 },{ -4,-4 },{ -3,-3 },{ -2,-2 },{ -1,-1 },{ -1,-1 },{ 0,0 },{ 1,1 },{ 1,1 },{ 2,2 },{ 3,3 },{ 4,4 },{ 4,4 },{ 5,5 },{ 6,6 },{ 6,6 },{ 7,7 },{ 8,8 },{ 8,8 },{ 9,9 },{ 10,10 } },{ { -8,-13 },{ -7,-12 },{ -6,-11 },{ -6,-10 },{ -6,-10 },{ -5,-9 },{ -4,-8 },{ -4,-7 },{ -4,-6 },{ -3,-5 },{ -2,-4 },{ -2,-3 },{ -2,-3 },{ -1,-2 },{ 0,-1 },{ 0,0 },{ 0,1 },{ 1,2 },{ 2,3 },{ 2,3 },{ 2,4 },{ 3,5 },{ 4,6 },{ 4,7 },{ 4,8 },{ 5,9 },{ 6,10 },{ 6,10 },{ 6,11 },{ 7,12 } },{ { -4,-14 },{ -4,-14 },{ -3,-13 },{ -3,-12 },{ -3,-11 },{ -3,-10 },{ -2,-9 },{ -2,-8 },{ -2,-7 },{ -2,-6 },{ -1,-5 },{ -1,-4 },{ -1,-3 },{ -1,-2 },{ 0,-1 },{ 0,0 },{ 0,1 },{ 1,2 },{ 1,3 },{ 1,4 },{ 1,5 },{ 2,6 },{ 2,7 },{ 2,8 },{ 2,9 },{ 3,10 },{ 3,11 },{ 3,12 },{ 3,13 },{ 4,14 } },{ { 0,-15 },{ 0,-14 },{ 0,-13 },{ 0,-12 },{ 0,-11 },{ 0,-10 },{ 0,-9 },{ 0,-8 },{ 0,-7 },{ 0,-6 },{ 0,-5 },{ 0,-4 },{ 0,-3 },{ 0,-2 },{ 0,-1 },{ 0,0 },{ 0,1 },{ 0,2 },{ 0,3 },{ 0,4 },{ 0,5 },{ 0,6 },{ 0,7 },{ 0,8 },{ 0,9 },{ 0,10 },{ 0,11 },{ 0,12 },{ 0,13 },{ 0,14 } },{ { 4,-14 },{ 4,-14 },{ 3,-13 },{ 3,-12 },{ 3,-11 },{ 3,-10 },{ 2,-9 },{ 2,-8 },{ 2,-7 },{ 2,-6 },{ 1,-5 },{ 1,-4 },{ 1,-3 },{ 1,-2 },{ 0,-1 },{ 0,0 },{ 0,1 },{ -1,2 },{ -1,3 },{ -1,4 },{ -1,5 },{ -2,6 },{ -2,7 },{ -2,8 },{ -2,9 },{ -3,10 },{ -3,11 },{ -3,12 },{ -3,13 },{ -4,14 } },{ { 8,-13 },{ 7,-12 },{ 6,-11 },{ 6,-10 },{ 6,-10 },{ 5,-9 },{ 4,-8 },{ 4,-7 },{ 4,-6 },{ 3,-5 },{ 2,-4 },{ 2,-3 },{ 2,-3 },{ 1,-2 },{ 0,-1 },{ 0,0 },{ 0,1 },{ -1,2 },{ -2,3 },{ -2,3 },{ -2,4 },{ -3,5 },{ -4,6 },{ -4,7 },{ -4,8 },{ -5,9 },{ -6,10 },{ -6,10 },{ -6,11 },{ -7,12 } },{ { 11,-11 },{ 10,-10 },{ 9,-9 },{ 8,-8 },{ 8,-8 },{ 7,-7 },{ 6,-6 },{ 6,-6 },{ 5,-5 },{ 4,-4 },{ 4,-4 },{ 3,-3 },{ 2,-2 },{ 1,-1 },{ 1,-1 },{ 0,0 },{ -1,1 },{ -1,1 },{ -2,2 },{ -3,3 },{ -4,4 },{ -4,4 },{ -5,5 },{ -6,6 },{ -6,6 },{ -7,7 },{ -8,8 },{ -8,8 },{ -9,9 },{ -10,10 } },{ { 13,-8 },{ 12,-7 },{ 11,-6 },{ 10,-6 },{ 10,-6 },{ 9,-5 },{ 8,-4 },{ 7,-4 },{ 6,-4 },{ 5,-3 },{ 4,-2 },{ 3,-2 },{ 3,-2 },{ 2,-1 },{ 1,0 },{ 0,0 },{ -1,0 },{ -2,1 },{ -3,2 },{ -3,2 },{ -4,2 },{ -5,3 },{ -6,4 },{ -7,4 },{ -8,4 },{ -9,5 },{ -10,6 },{ -10,6 },{ -11,6 },{ -12,7 } },{ { 14,-4 },{ 14,-4 },{ 13,-3 },{ 12,-3 },{ 11,-3 },{ 10,-3 },{ 9,-2 },{ 8,-2 },{ 7,-2 },{ 6,-2 },{ 5,-1 },{ 4,-1 },{ 3,-1 },{ 2,-1 },{ 1,0 },{ 0,0 },{ -1,0 },{ -2,1 },{ -3,1 },{ -4,1 },{ -5,1 },{ -6,2 },{ -7,2 },{ -8,2 },{ -9,2 },{ -10,3 },{ -11,3 },{ -12,3 },{ -13,3 },{ -14,4 } } };


CFloatImage padImageForErosion(CFloatImage &image, int structSize);
CFloatImage padImageForDilation(CFloatImage &image, int structSize);
CFloatImage ErosionStructSquare(CFloatImage &grayImage, int structSize);
CFloatImage Erosion(CFloatImage &grayImage, int structType);
CFloatImage Dilation(CFloatImage &grayImage, int structType);
CFloatImage Opening(CFloatImage image, int structType);
CFloatImage Closing(CFloatImage image, int structType);
CFloatImage Erosion2(CFloatImage &grayImage, int structType);
CFloatImage Dilation2(CFloatImage &grayImage, int structType);
CFloatImage Opening2(CFloatImage image, int structType);
CFloatImage Closing2(CFloatImage image, int structType);
CFloatImage GeodesicDilation(CFloatImage marker, CFloatImage mask, int size);
CFloatImage GeodesicOpening(CFloatImage marker, CFloatImage mask);
CFloatImage GeodesicClosing(CFloatImage marker, CFloatImage image);
CFloatImage GeodesicClosing(CFloatImage marker, CFloatImage image);
CFloatImage vesselSegmentation(CFloatImage &image);

#endif
